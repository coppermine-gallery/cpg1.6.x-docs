(function(a){a.fn.fullsize=function(k){var b=a.extend({zoomInSpeed:200,zoomOutSpeed:200,fadeInSpeed:250,fadeOutSpeed:250,leftOffset:0,topOffset:0,iconOffset:8,forceTitleBar:!1,destroy:!1,start:function(){},end:function(){}},k);a(document).keydown(function(p){27==p.keyCode&&(a("div.fullsize-wrapper").fadeOut(b.fadeOutSpeed,function(){a(this).remove()}),b.end.call(this))});return this.each(function(){if(1==b.destroy)a(this).unbind();else if(a(this).attr("longdesc")){var p=function(f,g,d,h){var c=d.offset();
a(f).fadeOut(b.fadeOutSpeed).animate({height:d.height(),width:d.width()},{queue:!1,duration:b.zoomOutSpeed});a(g).fadeOut(b.fadeOutSpeed).animate({width:d.width(),marginTop:c.top,marginLeft:c.left},{queue:!1,duration:b.zoomOutSpeed,complete:function(){h.remove()}});b.end.call(this)},h=a(this),q=h.attr("title"),k=h.attr("longdesc");a(this).click(function(){b.start.call(this);a("div.fullsize-wrapper").remove();var f=a(window).width(),g=a(window).height(),d=a(window).scrollTop(),n=a(window).scrollLeft();
if(!a.support.opacity&&"8">parseInt(a.browser.version.substr(0,1)))var c=(f-b.leftOffset)/2+n-25,e=(g-b.topOffset)/2+d-25;else c=(f+b.leftOffset)/2+n-25,e=(g+b.topOffset)/2+d-25;c=a("<div></div>").addClass("fullsize-loading").css({"margin-left":c,"margin-top":e});e=a("<div></div>").addClass("fullsize-loading-inner");a(c).prepend(e);a("body").prepend(c);var r=new Image;a(r).load(function(){a(this).hide();var c=h.offset();img_w=this.width;img_h=this.height;aspect=img_w/img_h;img_w+b.leftOffset+32>f&&
(img_w=f-b.leftOffset-32,img_h=img_w/aspect);img_h+b.topOffset+36>g&&(img_h=g-b.topOffset-36,img_w=img_h*aspect);if(!a.support.opacity&&"8">parseInt(a.browser.version.substr(0,1)))var e=Math.round((f-b.leftOffset-img_w)/2+n),l=Math.round((g-b.topOffset-img_h)/2+d);else e=Math.round((f+b.leftOffset-img_w)/2+n),l=Math.round((g+b.topOffset-img_h)/2+d);0>e&&(e=0);0>l&&(l=0);a(this).css({height:h.height()+"px",width:h.width()+"px"});a("div.fullsize-loading").remove();var m=a("<div></div>").addClass("fullsize-wrapper").css({display:"none",
"margin-top":c.top,"margin-left":c.left});a(m).prepend(this);if(""!=q||1==b.forceTitleBar){var c=a("<a></a>").addClass("fullsize-close"),k=a("<div></div>").addClass("fullsize-title").css({"max-width":img_w}),t=a("<div></div>").addClass("fullsize-title-text").text(q);a(k).prepend(c);a(k).prepend(t);a(m).prepend(k);a("body").prepend(m);0!=l&&(l-=12)}else a(this).addClass("fullsize-close"),a("body").prepend(m);a(this).fadeIn(b.fadeInSpeed).animate({height:img_h,width:img_w},{queue:!1,duration:b.zoomInSpeed});
a(m).fadeIn(b.fadeInSpeed).animate({width:img_w,marginTop:l,marginLeft:e},{queue:!1,duration:b.zoomInSpeed});a(".fullsize-close").click(function(){p(r,m,h,a(this))})}).attr("src",k).addClass("fullsize-image")})}})}})(jQuery);